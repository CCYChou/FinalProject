# 晶圓測試數據分析與預測專案

## 目錄
1. [商業理解](#商業理解)
2. [數據理解](#數據理解)
3. [數據準備](#數據準備)
4. [建模](#建模)
5. [評估](#評估)
6. [部署](#部署)

## 商業理解

### 專案背景
本專案旨在通過深度學習技術Vision Transformer (ViT)對晶圓測試數據進行分析和缺陷分類。在半導體製造過程中，及時準確地識別和分類晶圓缺陷對於提高產品良率和降低成本具有重要意義。

### 業務目標
- 建立高準確度的晶圓缺陷分類模型
- 提高缺陷檢測的自動化程度
- 降低人工檢測成本
- 提升產品良率

## 數據理解

### 數據概況
- 訓練集大小：30,004筆資料，每筆32x32像素
- 測試集大小：7,502筆資料，每筆32x32像素
- 類別數量：9種不同的缺陷類型

### 缺陷類型分布
1. Center
2. Donut
3. Edge-Loc
4. Edge-Ring
5. Loc
6. Near-full
7. Random
8. Scratch
9. none（無缺陷）

## 數據準備

### 數據預處理
- 將圖像數據標準化
- 增加通道維度
- 標籤編碼處理
- 數據加載器批次大小設置為32
- 應用patch embedding處理圖像

## 建模

### 模型架構
使用Vision Transformer (ViT)模型，主要特點：
- 圖像大小：32x32
- Patch大小：16x16
- 嵌入維度：256
- 注意力頭數：8
- Transformer層數：6
- 輸出類別數：9

### 訓練參數
- 學習率：0.0001
- 優化器：Adam
- 損失函數：CrossEntropyLoss
- 訓練周期：50

### 訓練過程
![訓練過程圖]![Vit_20241222](https://github.com/user-attachments/assets/98d17bfa-bdf3-43e1-b9c3-8d6c7279defa)


訓練曲線顯示：
- 損失函數穩定下降
- 驗證準確率在訓練過程中逐步提升
- 最佳模型出現在第43個epoch

## 評估

### 整體性能
- 最佳驗證準確率：87.36%
- 最終訓練損失：0.0342
- 正確預測數：6,554/7,502

### 分類報告
各類別的性能指標：
- Center: 精確率0.92, 召回率0.95
- Edge-Ring: 精確率0.95, 召回率0.98
- none: 精確率0.89, 召回率0.92

### 混淆矩陣分析
![混淆矩陣]![Vit_2_20241222](https://github.com/user-attachments/assets/6d045759-7c2a-413f-99ba-06260a55efa4)


主要發現：
- Edge-Ring類別表現最好，準確率達97.81%
- Scratch類別表現較差，準確率僅20.43%
- 大多數類別的準確率都在80%以上

## 部署

### 模型保存
- 最佳模型已保存為'best_wafer_vit_model.pth'
- 包含完整的模型狀態字典

### 使用建議
- 建議在GPU環境下運行
- 需要定期使用新數據重新訓練模型
- 可以考慮進一步優化Scratch類別的識別能力

### 未來改進方向
1. 增加數據增強方法
2. 針對表現較差的類別增加樣本
3. 嘗試不同的模型架構或參數組合
4. 引入其他特徵提取方法
