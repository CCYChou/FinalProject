# Wafer Map分類專案

## 目錄
1. [業務理解](#業務理解)
2. [數據理解](#數據理解)
3. [數據準備](#數據準備)
4. [建模](#建模)
5. [評估](#評估)
6. [部署](#部署)

## 業務理解

### 專案背景
本專案旨在開發一個自動化的晶圓圖(Wafer Map)分類系統，用於半導體製造過程中的品質控制。我們使用深度學習技術，特別是FasterViT模型，來實現晶圓缺陷的自動分類。

### 業務目標
- 提高晶圓缺陷檢測的準確性
- 減少人工檢測的時間和成本
- 實現製程品質的即時監控
- 提供可靠的缺陷分類報告

## 數據理解

### 數據概況
- 訓練集：30,004筆數據，尺寸(30004, 32, 32)
- 測試集：7,502筆數據，尺寸(7502, 32, 32)
- 類別數：9種不同的缺陷類型
- 缺陷類型包括：Center, Donut, Edge-Loc, Edge-Ring, Loc, Near-full, Random, Scratch, none

### 類別分布
根據最終的分類報告，各類別的支持數量如下：
- Center: 859筆
- Donut: 95筆
- Edge-Loc: 1027筆
- Edge-Ring: 1960筆
- Loc: 712筆
- Near-full: 27筆
- Random: 172筆
- Scratch: 235筆
- none: 2415筆

## 數據準備

### 數據預處理
1. 圖像尺寸調整：
   - 原始圖像：32x32
   - 調整至：224x224（使用雙三次插值）
2. 通道轉換：
   - 從單通道轉換為三通道
   - 應用標準化處理（均值：[0.485, 0.456, 0.406]，標準差：[0.229, 0.224, 0.225]）
3. 資料擴增：
   - 使用基本的圖像轉換
   - 保持原始特徵的完整性

## 建模

### 模型架構
使用FasterViT-0模型，主要特點：
- 基礎維度：64
- 層深度配置：[2, 3, 6, 5]
- 注意力頭數：[2, 4, 8, 16]
- 窗口大小：[7, 7, 7, 7]

### 訓練參數
- 批次大小：16
- 優化器：AdamW
- 初始學習率：1e-3
- 權重衰減：0.05
- 學習率調度：CosineAnnealingLR
- 訓練週期：50

### 訓練過程
![訓練損失與準確率趨勢](training_history.png)

訓練過程展示了模型的學習曲線：
- 訓練損失從初始的0.62持續下降到0.015
- 驗證準確率從85%逐步提升到90%以上
- 最佳驗證準確率達到90.62%（第48個週期）

## 評估

### 模型性能
- 最終測試準確率：90.36%
- 混淆矩陣分析：
![混淆矩陣](confusion_matrix.png)

### 各類別性能指標
| 類別      | 精確率 | 召回率 | F1分數 |
|-----------|--------|--------|--------|
| Center    | 0.93   | 0.95   | 0.94   |
| Donut     | 0.82   | 0.82   | 0.82   |
| Edge-Loc  | 0.86   | 0.86   | 0.86   |
| Edge-Ring | 0.96   | 0.98   | 0.97   |
| Loc       | 0.76   | 0.77   | 0.77   |
| Near-full | 0.93   | 0.96   | 0.95   |
| Random    | 0.94   | 0.82   | 0.88   |
| Scratch   | 0.70   | 0.56   | 0.62   |
| none      | 0.92   | 0.93   | 0.92   |

### 主要發現
1. 模型在大多數類別上表現優秀，特別是Edge-Ring類別（F1分數0.97）
2. Scratch類別的性能相對較低（F1分數0.62），可能需要更多改進
3. 整體而言，模型展現出穩定且可靠的分類能力

## 部署

### 部署建議
1. 模型儲存
   - 保存最佳模型權重
   - 記錄所有訓練參數和配置

2. 整合流程
   - 建立自動化的數據預處理管道
   - 開發用戶友好的介面

3. 監控與維護
   - 建立性能監控機制
   - 定期進行模型更新和優化

### 未來改進方向
1. 數據增強
   - 擴充Scratch類別的訓練樣本
   - 應用更多數據增強技術

2. 模型優化
   - 探索不同的模型架構
   - 調整超參數配置

3. 系統整合
   - 開發實時推理系統
   - 提供API接口服務
