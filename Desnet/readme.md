# 晶圓瑕疵分類專案

## 目錄
1. [商業理解](#商業理解)
2. [資料理解](#資料理解)
3. [資料準備](#資料準備)
4. [模型建立](#模型建立)
5. [評估結果](#評估結果)
6. [部署建議](#部署建議)

## 商業理解
### 專案背景
- 此專案目的在於開發一個自動化的晶圓瑕疵檢測系統
- 透過深度學習技術，實現晶圓表面瑕疵的自動分類
- 提高生產線品質控制的效率和準確性

### 業務目標
- 降低人工檢測的成本和時間
- 提高瑕疵檢測的準確率
- 實現9種不同類型瑕疵的自動分類

## 資料理解
### 資料概述
- 訓練集：30,004筆資料 (32x32像素)
- 測試集：7,502筆資料 (32x32像素)
- 類別數：9種瑕疵類型
  - Center
  - Donut
  - Edge-Loc
  - Edge-Ring
  - Loc
  - Near-full
  - Random
  - Scratch
  - none (無瑕疵)

## 資料準備
### 資料預處理
- 標籤編碼處理
- 資料轉換為PyTorch張量格式
- 加入通道維度
- 批次處理（Batch size=32）

## 模型建立
### 模型架構
- 使用預訓練的DenseNet169模型
- 修改輸入層以接受單通道圖像
- 修改輸出層以符合9種分類
- 使用交叉熵損失函數
- 使用Adam優化器

### 訓練過程
- 訓練週期：50 epochs
- 批次大小：32
- 學習率：0.001
- 硬體：NVIDIA GeForce RTX 4060

### 訓練結果視覺化
#### 模型訓練過程
![訓練過程]![Desnet](https://github.com/user-attachments/assets/8197a21b-8801-46a8-9190-57ec029269ce)
- 左圖顯示損失函數下降趨勢
- 右圖顯示驗證準確率的變化

#### 混淆矩陣
![混淆矩陣]![Desnet-2](https://github.com/user-attachments/assets/130838f7-bf98-48f1-8018-1da8f799f4ac)
- 顯示各類別之間的預測結果
- 對角線數值越高表示該類別預測越準確

## 評估結果
### 整體表現
- 最佳驗證準確率：89.04% (第37個epoch)
- 最終模型準確率：89.04%
- 總樣本數：7,502
- 正確預測數：6,680

### 各類別表現
類別準確率：
- Edge-Ring: 97.24% (表現最佳)
- none: 93.91%
- Near-full: 92.59%
- Center: 91.15%
- Donut: 89.47%
- Edge-Loc: 84.23%
- Random: 76.16%
- Loc: 72.89%
- Scratch: 41.70% (表現最差)

### 詳細指標
|類別|Precision|Recall|F1-score|Support|
|---|---------|------|--------|--------|
|Center|0.94|0.91|0.93|859|
|Donut|0.85|0.89|0.87|95|
|Edge-Loc|0.84|0.84|0.84|1027|
|Edge-Ring|0.97|0.97|0.97|1960|
|Loc|0.75|0.73|0.74|712|
|Near-full|0.81|0.93|0.86|27|
|Random|0.92|0.76|0.83|172|
|Scratch|0.72|0.42|0.53|235|
|none|0.88|0.94|0.91|2415|

## 部署建議
### 改進方向
1. 針對Scratch類別的優化
   - 增加Scratch類別的訓練樣本
   - 考慮使用資料增強技術
   - 可能需要專門的模型架構

2. 類別不平衡處理
   - 考慮使用過採樣或欠採樣技術
   - 實施加權損失函數
   - 評估是否需要合併某些類別

3. 模型優化
   - 嘗試不同的學習率策略
   - 考慮使用其他預訓練模型
   - 實施更強的正則化技術

### 生產環境建議
1. 硬體需求
   - 建議使用具有NVIDIA GPU的環境
   - 最小記憶體需求：16GB
   - 建議使用SSD存儲

2. 監控機制
   - 建立預測結果的日誌系統
   - 定期進行模型效能評估
   - 設置預警機制для異常檢測

3. 維護計劃
   - 定期使用新數據重新訓練模型
   - 建立模型版本控制機制
   - 制定緊急回滾方案
